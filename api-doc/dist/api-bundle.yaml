swagger: '2.0'
info:
  description: GBM API spec
  version: 0.0.1
  title: GBM API
  contact:
    name: '@'
  license:
    name: Apache 2.0
tags:
  - name: webapp
    description: General Webapp endpoint
  - name: api
    description: General API endpoint
paths:
  /vehicle:
    post:
      tags:
        - api
      operationId: postVehicle
      summary: New vehicle
      consumes:
        - applicaton/json
      produces:
        - application/json
      parameters:
        - in: body
          name: Vehicle
          schema:
            $ref: '#/definitions/Vehicle'
      responses:
        '200':
          description: New vehicle
          schema:
            $ref: '#/definitions/Vehicle'
  /vehicles:
    get:
      tags:
        - api
      operationId: getPaginatedVehicles
      summary: All vehicles paginated
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/pagination'
      responses:
        '200':
          description: Get vehicles ordered by creation date
          schema:
            type: array
            items:
              $ref: '#/definitions/Vehicle'
            maxItems: 10
  '/vehicle/{vehicleID}':
    get:
      tags:
        - api
      operationId: getVehicleByID
      summary: Vehicle info
      consumes:
        - applicaton/json
      produces:
        - application/json
      parameters:
        - in: path
          name: vehicleID
          description: Vehicle ID
          required: true
          type: string
      responses:
        '200':
          description: vehicle info
          schema:
            $ref: '#/definitions/Vehicle'
  '/vehicle/{vehicleID}/location':
    get:
      tags:
        - api
      operationId: getLocationsVehicleByID
      summary: Latest locations
      consumes:
        - applicaton/json
      produces:
        - application/json
      parameters:
        - in: path
          name: vehicleID
          description: Vehicle ID
          required: true
          type: string
        - $ref: '#/parameters/pagination'
      responses:
        '200':
          description: vehicle info
          type: array
          items:
            $ref: '#/definitions/Position'
          maxItems: 10
    post:
      tags:
        - api
      operationId: postLastestVehiclePosition
      summary: Report vehicle position
      consumes:
        - applicaton/json
      produces:
        - application/json
      parameters:
        - in: path
          name: vehicleID
          description: vehicle id
          required: true
          type: string
        - in: body
          name: position
          schema:
            $ref: '#/definitions/Position'
      responses:
        '201':
          description: Report vehicle position
          schema:
            $ref: '#/definitions/Message'
definitions:
  Message:
    required:
      - code
      - description
    properties:
      code:
        type: string
        description: Describe code error
      description:
        type: string
        description: Details of the error
        maxLength: 255
    type: object
  Vehicle:
    required:
      - name
    properties:
      id:
        type: string
        pattern: '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'
        format: uuid
      plate:
        type: string
    type: object
  Position:
    required:
      - lat
      - lon
    properties:
      id:
        type: string
        pattern: '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'
        format: uuid
      lat:
        type: string
        faker: address.latitude
      lon:
        type: string
        faker: address.longitude
      timestamp:
        type: string
        formar: date-time
    type: object
parameters:
  pagination:
    in: query
    name: page
    description: 'Page to return, default to zero'
    required: false
    type: integer
